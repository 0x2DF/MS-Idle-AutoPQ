name: "Normal KPQ Run"

steps:
  - include: "../../general/open_main_menu.yaml"

  - name: "Open Party Quest"
    find: "assets/screens/Main_Menu/party_quest_adb.png"

  - name: "Open KPQ Menu"
    find: "assets/screens/Party_Quest/kpq_adb.png"

  - loop:
      iterations: "infinite"
      steps:
        - name: "Queue KPQ"
          find: "assets/screens/KPQ/auto_match_adb.png"
          verify_state_change: true
          verify_delay: 2
          verify_retries: 3

        - name: "Accept Party Quest"
          find: "assets/screens/Party_Quest/Matching_Complete/accept_adb.png"
          retry_delay: 3
          retries: 300
          # 3 * 300 / 60 = 15 minutes max queue time
          verify_state_change: true
          verify_delay: 2
          verify_retries: 5

        - name: "Leave Party Quest"
          find: "assets/screens/Party_Quest/Clear/leave_adb.png"
          retry_delay: 6
          retries: 100
          # 6 * 100 / 60 = 10 minutes max pq time
          verify_state_change: true
          verify_delay: 2
          verify_retries: 5