name: "Normal KPQ Run"

steps:
  - include: "../../general/open_main_menu.yaml"

  - name: "open_party_quest"
    find: "assets/screens/Main_Menu/party_quest.png"

  - name: "open_kpq_menu"
    find: "assets/screens/Party_Quest/kpq.png"

  - loop:
      iterations: "infinite"
      steps:
        - name: "queue_kpq"
          find: "assets/screens/KPQ/auto_match.png"
          verify_state_change: true
          verify_delay: 2
          verify_retries: 3

        - name: "accept_party_quest"
          find: "assets/screens/Party_Quest/Matching_Complete/accept.png"
          start_delay: 5
          retry_delay: 3
          retries: 300
          verify_state_change: true
          verify_delay: 2
          verify_retries: 5
          # 3 * 300 / 60 = 15 minutes max queue time

        - name: "leave_party_quest"
          find: "assets/screens/Party_Quest/Clear/leave.png"
          start_delay: 60
          retry_delay: 3
          retries: 100
          # 3 * 100 / 60 = 1+5 minutes max pq time